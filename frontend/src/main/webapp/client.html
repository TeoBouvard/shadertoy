<!DOCTYPE html>
<html>

    <head>
        <title>Positif</title>
        <meta charset="UTF-8">

        <!-- Librairie Javascript: jQuery (v3.3.1) -->
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" type="text/CSS" href="client.css">
    </head>

    <body>
        <div id="bloc-page">
            <div id="left-panel">
                <div id="description">
                    <label id="nom-client">Nom</label><br>
                    <label id="prenom-client">Prenom</label><br>
                </div>
                <div id="navigation">
                    <button id="bouton-accueil" disabled> <b> Accueil </b> </button><br>
                    <button id="bouton-profil" onclick="location = 'profil-astro.html';"><b> Profil Astro </b></button><br>
                    <button id="bouton-historique" onclick="location = 'historique.html';"><b> Historique </b></button>
                </div>
                <button id="bouton-deconnecter"><b> Se déconnecter </b></button>
            </div>

            <div id="bloc-mediums">
                <h1>Mediums</h1>
                <ul id="liste-medium"></ul>
            </div>

            <div id="bloc-infos-medium">
                <h1 id="nom-medium"></h1>
                <h1 id="type-medium"></h1>
                <h1 id="description-medium"></h1>
                <h1 id="formation-medium"></h1>
                <h1 id="promotion-medium"></h1>
                <h1 id="specialite-medium"></h1>
                <button id="prendre-rdv">Prendre RDV</button>
            </div>

        </div>

        <script>
            $(document).ready(function () {
                GetInfoClient();
                GetListMedium();
            });

            function GetInfoClient() {
                $.ajax({
                    url: './ActionServlet', // URL
                    method: 'POST', // Méthode
                    data: {// Paramètres
                        todo: 'infos-client'
                    },
                    dataType: 'json'        // Type de retour attendu
                }).done(function (response) {
                    $('#nom-client').html(response.nom);
                    $('#prenom-client').html(response.prenom);
                })
            }

            function GetListMedium() {
                $.ajax({
                    url: './ActionServlet', // URL
                    method: 'POST', // Méthode
                    data: {// Paramètres
                        todo: 'liste-medium'
                    },
                    dataType: 'json'        // Type de retour attendu
                }).done(function (response) {
                    $.each(response.listemedium, function (i, medium) {
                        $("#liste-medium").append("<li onclick=\"afficherMedium(" + medium.id + ");\">" + medium.nom + " " + medium.type + "</li>");
                    })
                })
            }

            function afficherMedium(id) {
                $.ajax({
                    url: './ActionServlet', // URL
                    method: 'POST', // Méthode
                    data: {// Paramètres
                        todo: 'infos-medium',
                        id: id
                    },
                    dataType: 'json'        // Type de retour attendu
                }).done(function (response) {
                    $("#nom-medium").html(response.nom);
                    $("#type-medium").html(response.type);
                    $("#description-medium").html("Description : " + response.description);
                    if (response.type === "Voyant") {
                        $("#specialite-medium").html("Specialité : " + response.specialite);
                    } else if (response.type === "Astrologue") {
                        $("#formation-medium").html("Formation : " + response.formation);
                        $("#promotion-medium").html("Promotion : " + response.promotion);
                    }
                });
            }

        </script>

    </body>

</html>